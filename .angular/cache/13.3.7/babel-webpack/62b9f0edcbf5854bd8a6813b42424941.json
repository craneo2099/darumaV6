{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/providers/daruma-service/daruma.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\n\nfunction RecuperarPage_ion_item_28_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \" Campo requerido \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RecuperarPage_ion_item_28_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \" Escribe tu e-mail (nombre@dominio.com) \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RecuperarPage_ion_item_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-text\", 26);\n    i0.ɵɵtemplate(2, RecuperarPage_ion_item_28_p_2_Template, 2, 0, \"p\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-text\", 26);\n    i0.ɵɵtemplate(4, RecuperarPage_ion_item_28_p_4_Template, 2, 0, \"p\", 16);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.recuperarForm.get(\"correo\").hasError(\"required\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.recuperarForm.get(\"correo\").hasError(\"pattern\"));\n  }\n}\n\nfunction RecuperarPage_ng_container_36_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-text\", 26)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const validation_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(validation_r5.message);\n  }\n}\n\nfunction RecuperarPage_ng_container_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, RecuperarPage_ng_container_36_ion_item_1_Template, 4, 1, \"ion-item\", 16);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const validation_r5 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.recuperarForm.get(\"captcha\").hasError(validation_r5.type) && (ctx_r1.recuperarForm.get(\"captcha\").dirty || ctx_r1.recuperarForm.get(\"captcha\").touched));\n  }\n}\n\nfunction RecuperarPage_ion_footer_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-footer\", 27)(1, \"ion-grid\", 28)(2, \"ion-row\")(3, \"ion-col\", 29)(4, \"div\", 30)(5, \"small\");\n    i0.ɵɵtext(6, \"Powered by \");\n    i0.ɵɵelementStart(7, \"b\");\n    i0.ɵɵtext(8, \"Devstar Novatech.\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n}\n\nexport let RecuperarPage = /*#__PURE__*/(() => {\n  class RecuperarPage {\n    constructor(router, ngZone, ds, alertCtrl, loadingCtrl, formBuilder) {\n      this.router = router;\n      this.ngZone = ngZone;\n      this.ds = ds;\n      this.alertCtrl = alertCtrl;\n      this.loadingCtrl = loadingCtrl;\n      this.formBuilder = formBuilder;\n      this.isKeyboardHide = true;\n      this.validation_messages = {\n        'captcha': [{\n          type: 'required',\n          message: 'Campo Requerido'\n        }, {\n          type: 'minlength',\n          message: 'M\\u00EDnimo 6 caracteres'\n        }, {\n          type: 'maxlength',\n          message: 'M\\u00E1ximo 6 caracteres'\n        }]\n      };\n      this.recuperarForm = this.formBuilder.group({\n        correo: ['', Validators.compose([Validators.required, Validators.pattern('^[_A-Za-z0-9-\\\\+]+(\\\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\\\.[A-Za-z0-9]+)*(\\\\.[A-Za-z]{2,})$')])],\n        captcha: ['', Validators.compose([Validators.required, Validators.minLength(6), Validators.maxLength(6)])]\n      });\n    }\n\n    enviarMail() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.loader = yield this.loadingCtrl.create();\n        yield this.loader.present();\n        console.log(\"correo\", this.recuperarForm.value.correo);\n\n        if (this.recuperarForm.get('correo').hasError('required') || this.recuperarForm.get('captcha').hasError('required')) {\n          yield this.loader.dismiss();\n          this.doAlert(\"Error!!!\", \"Campo requerido\", null);\n        } else {\n          if (this.recuperarForm.get('correo').errors && this.recuperarForm.get('correo').dirty && this.recuperarForm.get('correo').hasError('pattern')) {\n            console.log(\"No entra\");\n            yield this.loader.dismiss();\n            this.doAlert(\"Error!!!\", \"Escribe el correo correctamente\", null);\n          } else if (this.recuperarForm.get('captcha').hasError('minlength')) {\n            yield this.loader.dismiss();\n            this.doAlert(\"Error!!!\", \"Captcha: \" + this.validation_messages.captcha[1][\"message\"], null);\n          } else if (this.recuperarForm.get('captcha').hasError('maxlength')) {\n            yield this.loader.dismiss();\n            this.doAlert(\"Error!!!\", \"Captcha: \" + this.validation_messages.captcha[2][\"message\"], null);\n          } else {\n            console.log(\"Entroooo\");\n            let infoCaptcha = {\n              token: this.tokenR,\n              word: this.recuperarForm.value.captcha\n            }; // requerirPass\n\n            this.ds.requerirPass(this.recuperarForm.value.correo, infoCaptcha).subscribe(res2 => __awaiter(this, void 0, void 0, function* () {\n              console.log(\"res2\", res2);\n              yield this.loader.dismiss();\n\n              if (res2[\"result\"] == \"NO_HUMANO\" && res2[\"response\"] == false) {\n                yield this.loader.dismiss();\n                this.doAlert(\"Alerta!\", \"Verifica el Texto\", \"Que sea el mismo de la imagen\");\n                console.log(\"Error Captcha\");\n              } else {\n                this.doAlertConfirm(\"Info\", \"Se ha enviado el correo, Sigue los pasos para reestablecer tu contraseña\");\n              }\n            }), error => __awaiter(this, void 0, void 0, function* () {\n              console.log(\"error al registrar\", error);\n              yield this.loader.dismiss();\n              this.doAlert(\"Error!!!\", \"Captcha incorrecto\", null);\n            }));\n          }\n        }\n      });\n    }\n\n    obtnerCaptchaTs() {\n      this.ds.obtenerCaptcha().subscribe(res => {\n        this.imgUrl = res[\"result\"][\"captcha\"];\n        this.tokenR = res[\"result\"][\"token\"];\n      }, error => {\n        console.log(\"error obtener Captcha\", error);\n      });\n    }\n\n    doAlert(titulo, subtitulo, texto) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let alert = yield this.alertCtrl.create({\n          header: titulo,\n          subHeader: subtitulo,\n          message: texto,\n          backdropDismiss: false,\n          buttons: ['Ok']\n        });\n        yield alert.present();\n      });\n    }\n\n    doAlertConfirm(titulo, texto) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let alert = yield this.alertCtrl.create({\n          header: titulo,\n          subHeader: texto,\n          backdropDismiss: false,\n          buttons: [{\n            text: 'Ok',\n            handler: () => {\n              this.router.navigate(['inicio-login']);\n            }\n          }]\n        });\n        yield alert.present();\n      });\n    }\n\n    ionViewWillEnter() {\n      this.obtnerCaptchaTs();\n      window.addEventListener('keyboardWillHide', () => {\n        this.ngZone.run(() => {\n          this.isKeyboardHide = true;\n        });\n      });\n      window.addEventListener('keyboardWillShow', e => {\n        this.ngZone.run(() => {\n          this.isKeyboardHide = false;\n        });\n      });\n    }\n\n    ngOnInit() {}\n\n  }\n\n  RecuperarPage.ɵfac = function RecuperarPage_Factory(t) {\n    return new (t || RecuperarPage)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i2.DarumaService), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(i3.LoadingController), i0.ɵɵdirectiveInject(i4.FormBuilder));\n  };\n\n  RecuperarPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RecuperarPage,\n    selectors: [[\"app-recuperar\"]],\n    decls: 43,\n    vars: 5,\n    consts: [[\"slot\", \"start\"], [1, \"colorFondo\", \"ion-padding-vertical\"], [\"fixed\", \"true\", 1, \"ion-no-padding\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"ion-justify-content-center\"], [\"src\", \"../../assets/imgs/LogoKoiCT.png\", \"alt\", \"logoKoiHT2\", 1, \"imgRed\", \"noMostrarG\"], [\"src\", \"../../assets/imgs/logoKoiHT2.png\", \"alt\", \"logoKoiHT2\", 1, \"imgRed\", \"noMostrarChico\"], [1, \"paddingBottomM\", \"ion-justify-content-center\"], [\"size\", \"11\", \"size-md\", \"8\", 1, \"marginLeftM\"], [\"color\", \"rosa\"], [1, \"ion-no-margin\", \"ion-margin-top\"], [\"size\", \"12\", \"size-md\", \"8\", 1, \"ion-no-padding\"], [\"position\", \"floating\", \"color\", \"primary\"], [\"name\", \"person\"], [\"color\", \"gris\"], [\"type\", \"email\", \"clearInput\", \"true\", \"formControlName\", \"correo\", \"required\", \"\"], [4, \"ngIf\"], [\"size\", \"6\"], [1, \"\", 3, \"src\"], [\"type\", \"\", \"name\", \"captcha\", \"formControlName\", \"captcha\", \"clearInput\", \"true\", \"placeholder\", \"Escribe el texto\"], [4, \"ngFor\", \"ngForOf\"], [1, \"ion-justify-content-center\", \"ion-padding-horizontal\", \"ion-padding-top\"], [\"size\", \"12\", \"size-md\", \"6\"], [\"type\", \"submit\", \"color\", \"verde\", \"expand\", \"block\"], [\"slot\", \"start\", \"name\", \"mail\"], [\"class\", \"footerColor\", 4, \"ngIf\"], [\"color\", \"danger\"], [1, \"footerColor\"], [1, \"ion-no-padding\"], [\"size\", \"12\"], [1, \"ion-text-center\"]],\n    template: function RecuperarPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n        i0.ɵɵelement(3, \"ion-back-button\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"Recuperar Contrase\\u00F1a\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\", 1)(7, \"ion-grid\", 2)(8, \"form\", 3);\n        i0.ɵɵlistener(\"ngSubmit\", function RecuperarPage_Template_form_ngSubmit_8_listener() {\n          return ctx.enviarMail();\n        });\n        i0.ɵɵelementStart(9, \"ion-row\", 4);\n        i0.ɵɵelement(10, \"img\", 5)(11, \"img\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"ion-row\", 7)(13, \"ion-col\", 8)(14, \"ion-text\", 9)(15, \"p\", 10)(16, \"b\");\n        i0.ɵɵtext(17, \"Escribe tu correo electr\\u00F3nico:\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(18, \"ion-row\", 4)(19, \"ion-col\", 11)(20, \"ion-item\")(21, \"ion-label\", 12);\n        i0.ɵɵelement(22, \"ion-icon\", 13);\n        i0.ɵɵtext(23, \" Correo \");\n        i0.ɵɵelementStart(24, \"ion-text\", 14)(25, \"span\");\n        i0.ɵɵtext(26, \"(e-mail)\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(27, \"ion-input\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(28, RecuperarPage_ion_item_28_Template, 5, 2, \"ion-item\", 16);\n        i0.ɵɵelementStart(29, \"ion-row\")(30, \"ion-col\", 17)(31, \"ion-item\");\n        i0.ɵɵelement(32, \"img\", 18);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(33, \"ion-col\", 17)(34, \"ion-item\");\n        i0.ɵɵelement(35, \"ion-input\", 19);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(36, RecuperarPage_ng_container_36_Template, 2, 1, \"ng-container\", 20);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(37, \"ion-row\", 21)(38, \"ion-col\", 22)(39, \"ion-button\", 23);\n        i0.ɵɵelement(40, \"ion-icon\", 24);\n        i0.ɵɵtext(41, \" Enviar Correo \");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵtemplate(42, RecuperarPage_ion_footer_42_Template, 9, 0, \"ion-footer\", 25);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"formGroup\", ctx.recuperarForm);\n        i0.ɵɵadvance(20);\n        i0.ɵɵproperty(\"ngIf\", ctx.recuperarForm.get(\"correo\").errors && ctx.recuperarForm.get(\"correo\").dirty);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.imgUrl, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.validation_messages.captcha);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.isKeyboardHide);\n      }\n    },\n    directives: [i3.IonHeader, i3.IonToolbar, i3.IonButtons, i3.IonBackButton, i3.IonBackButtonDelegate, i3.IonTitle, i3.IonContent, i3.IonGrid, i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i3.IonRow, i3.IonCol, i3.IonText, i3.IonItem, i3.IonLabel, i3.IonIcon, i3.IonInput, i3.TextValueAccessor, i4.NgControlStatus, i4.FormControlName, i4.RequiredValidator, i5.NgIf, i5.NgForOf, i3.IonButton, i3.IonFooter],\n    styles: [\"\"]\n  });\n  return RecuperarPage;\n})();","map":null,"metadata":{},"sourceType":"module"}